"use strict";function FileUpload(){this.InputElement=null,this.PreviewBoxElement=null,this.CurentImageBox=null,this.Form=null,this.MaxFile=null,this.StoredFiles=[],this.CurentFiles=[],this.CurentPreviewImages=[],this.Extend=function(e,t,i,n,a,l,s,r,o,c,d,h){this.InputElement=n,this.AcceptExtention=n.accept.split(","),this.PreviewBoxElement=l,this.CurentImageBox=a,this.Form=s,this.UniqueControlName=d?"CurentFilePaths":"NewFiles"+d,this.MaxFile=r||2,this.MaxFileSize=h||5242880,this.InputChangeCallBack=void 0!==o?o:null,this.InputElement.addEventListener("change",this.InputChange),this.InputElement.fileUpload=this,this.FileReader=new FileReader,this.IsCreateInputName=c||!1,this.HostCdn=e||"",this.CurentFiles=t||[],this.CurentPreviewImages=i||[],this.Process()},this.Process=function(){if(this.CurentImageBox)for(var e=this,t=0;t<this.CurentFiles.length;t++){var i=this.CurentFiles[t],n=this.CurentPreviewImages[t],a=document.createElement("div");a.className="col-3 gutter-10 _p-item text-center";var l=document.createElement("figure");l.className="_max-height-200 relative hover-children-show";var s=document.createElement("button");s.className="absolute hide tablet-show -border width-100 height-100 _fill-silver-opacity text-strong",s.innerText="CLICK ĐỂ XÓA",s.type="button",s.dataset.file=i,s.dataset.notClose="I",s.addEventListener("click",function(t){e.RemoveCurentFile(t,e.InputElement)});var r,o,c=i.substring(i.lastIndexOf("/")+1),d=c.substring(c.indexOf(".")+1);if(("."+d).match(".jpg,.png,.svg,.gif,.jfif,.webp,.csv".replace(new RegExp(",","g"),"|"))?r="<img class='_max-width-100-percent'   onerror='this.src=\"/images/shared/no-image.svg\"'   src='"+e.HostCdn+"/"+n+"' alt='"+c+"' data-file='"+c+"' /><figcaption class='padding-5 text-center _text-ellipsis'>"+c+"</figcaption>":(r="<svg xmlns='http://www.w3.org/2000/svg' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+d+"</tspan></text></svg>",(o=document.createElement("div")).innerHTML="<div class='row text-center _text-ellipsis'><a target='_blank' href='"+e.HostCdn+"/"+n+"'>"+c+"</a></div>"),e.IsCreateInputName)r+="<input type='text' class='_hidden'    name='"+e.UniqueControlName+"' value="+i+(e.Form?" form='"+e.Form.id+"'":"")+"></input>";l.innerHTML=r,l.insertBefore(s,l.childNodes[0]),a.appendChild(l),o&&a.appendChild(o),e.CurentImageBox.appendChild(a)}},this.InputChange=function(e){var t=e.target.fileUpload,i=e.target.files,n=Array.prototype.slice.call(i);t.PreviewBoxElement.innerHTML="",t.StoredFiles=[];for(var a=0;a<n.length;a++){var l=n[a];if(l.size>t.MaxFileSize)Site.NotifyFormFailed("Lỗi","File không được lớn hơn "+t.MaxFileSize/1048576+" mb");else if(t.StoredFiles.push(l),t.PreviewBoxElement===t.CurentImageBox&&(t.CurentFiles=[],t.CurentImageBox.innerHTML=""),t.StoredFiles.length+t.CurentFiles.length<=t.MaxFile){var s=new FileReader;s.onload=function(e){var i=event.target,n=document.createElement("div");n.className="gutter-10 _p-item";var a=document.createElement("figure");a.className="_max-height-200 relative hover-children-show";var l,s=document.createElement("button");(s.className="absolute hide -border width-100 height-100 _fill-silver-opacity text-strong",s.type="button",s.innerText="CLICK ĐỂ XÓA",s.dataset.file=i.name,s.dataset.notClose="I",s.addEventListener("click",function(e){t.RemoveFile(e,t.InputElement)}),i.fileType.match("image.*"))?l="<img class='width-100 _max-width-100-percent' src='"+e.target.result+"' alt='"+i.name+"' data-file='"+i.name+"' /><figcaption class='padding-5 text-center _text-ellipsis'>("+i.size%1e3+" kb) "+i.name+"</figcaption>":l="<svg xmlns='http://www.w3.org/2000/svg' width='100' height='100' viewBox='0 0 512 512' version='1'><path d='M128 0c-18 0-32 14-32 32v448c0 18 14 32 32 32h320c18 0 32-14 32-32V128L352 0H128z' fill='#e2e5e7'/><path d='M384 128h96L352 0v96c0 18 14 32 32 32z' fill='#b0b7bd'/><path fill='#cad1d8' d='M480 224l-96-96h96z'/><path d='M416 416c0 9-7 16-16 16H48c-9 0-16-7-16-16V256c0-9 7-16 16-16h352c9 0 16 7 16 16v160z' fill='#f15642'/><path d='M400 432H96v16h304c9 0 16-7 16-16v-16c0 9-7 16-16 16z' fill='#cad1d8'/><text y='375' x='212' style='line-height:1.25;text-align:center' font-weight='400' font-size='147' font-family='sans-serif' letter-spacing='0' word-spacing='0' text-anchor='middle' stroke-width='3'><tspan style='line-height:1.25;-inkscape-font-specification:'monospace Bold';text-align:center' y='375' x='212' font-weight='700' font-family='monospace' fill='#fff'>"+i.name.substring(i.name.indexOf(".")+1)+"</tspan></text></svg><figcaption class='padding-5 text-center _text-ellipsis'>("+i.size%1e3+" kb) "+i.name+"</figcaption>";t.IsCreateInputName&&(l+="<input type='text' class='_hidden' name='"+t.UniqueControlName+"[]' value="+i.name+(t.Form?" form='"+t.Form.id+"'":"")+"></input>");a.innerHTML=l,a.insertBefore(s,a.childNodes[0]),n.appendChild(a),t.PreviewBoxElement.appendChild(n)},s.size=l.size,s.fileType=l.type,s.name=l.name,s.readAsDataURL(l)}}t.InputChangeCallBack&&t.InputChangeCallBack(t.StoredFiles)},this.RemoveCurentFile=function(e){for(var t=e.target.dataset.file,i=0;i<this.CurentFiles.length;i++)if(this.CurentFiles[i]===t){this.CurentFiles.splice(i,1);break}Site.FindParent(e.target,"_p-item").remove()},this.RemoveFile=function(e,t){for(var i=e.target.dataset.file,n=0;n<this.StoredFiles.length;n++)if(this.StoredFiles[n].name===i){this.StoredFiles.splice(n,1);break}Site.FindParent(e.target,"_p-item").remove(),Site.ClearInputFile(t)},this.Init=function(e,t,i,n,a,l,s,r,o,c,d,h){var m=document.querySelector(n),u=document.querySelector(l),p=document.querySelector(a),g=document.querySelector(s);null!=m&&null!=u||console.warn(n+" or "+u+": NULL"),this.Extend(e,t,i,m,p,u,g,r,o,c,d,h)}}var listQuantities,chkOutOfStock,txtQuantity,attribute1Items,attribute2Items,productClassificationId,dataPrice,newestPostsContainer,activeProductClass,subscribeButton,discountPercentEle,flashSaleContainer,dataCountEle,dataProcessBarEle,dataDelPrice,listSections,dataHead,isFistLoad=!0,didScroll=!1,isClick=!1;function innitFileUpload(){var e=document.getElementById("inputRatingFormFile"),t=e.dataset.curentPathFiles&&""!==e.dataset.curentPathFiles?[e.dataset.curentPathFiles]:null,i=e.dataset.curentShowingImages&&""!==e.dataset.curentShowingImages?[e.dataset.curentShowingImages]:null,n=e.dataset.maxFile&&""!==e.dataset.maxFile?+e.dataset.maxFile:3,a=e.dataset.maxFile&&""!==e.dataset.maxSize?+e.dataset.maxSize:5;(new FileUpload).Init(null,t,i,"#inputRatingFormFile","#newReviewContainer","#newReviewContainer","#frmProductRating",n,console.log("change"),!0,"RatingFormFile",a)}function clearform(){$("#frmProductRating")[0].reset();var e=document.getElementById("newReviewContainer");e&&(e.innerHTML="")}function ratingCompleteCallBack(){location.reload()}document.addEventListener("DOMContentLoaded",function(){innitFileUpload()});