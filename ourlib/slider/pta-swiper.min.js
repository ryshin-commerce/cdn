var galleryThumbs,galleryTop;function SlideToProductClass(e){var t="class-"+e,l=Array.from(galleryTop.slides).filter(e=>!!e.classList&&e.classList.contains(t));if(l[0]){l.sort((e,t)=>Array.from(e.classList).filter(e=>!!e&&e.startsWith("class-")).length-Array.from(t.classList).filter(e=>!!e&&e.startsWith("class-")).length);var r=Array.from(galleryTop.slides).findIndex(e=>e.dataset.slide===l[0].dataset.slide);galleryTop.slideTo(r)}}function LoadSwiperDefault(){galleryTop=new Swiper(".gallery-top",{spaceBetween:20,preloadImages:!0,centeredSlides:!0,lazy:{loadPrevNext:!0},pagination:".swiper-pagination",paginationType:"fraction",navigation:{nextEl:".swiper-button-next",prevEl:".swiper-button-prev"}});var e=document.querySelector(".gallery-thumbs");if(e){if((galleryThumbs=new Swiper(".gallery-thumbs",{spaceBetween:20,centeredSlides:!0,slidesPerView:e.dataset.itemShow||4,touchRatio:.2,slideToClickedSlide:!0}))instanceof Array)for(var t=0;t<galleryThumbs.length;t++)galleryThumbs[t].imagesToLoad.length>0&&(galleryTop[t].controller.control=galleryThumbs,galleryThumbs[t].controller.control=galleryTop);else galleryTop.controller.control=galleryThumbs,galleryThumbs.controller.control=galleryTop;galleryThumbs.update()}}function _LoadImageSwipe(e,t){var l,r=document.querySelectorAll(".pswp")[0],o=document.querySelector(e),a=[],i=document.querySelectorAll(e+" .gallery-top .swiper-slide > [itemprop=contentUrl]"),s=document.querySelectorAll(e+" .gallery-top [itemprop=thumbnail] ._p-slide-image"),n=document.querySelector(e+" .swiper-slide-active");n||console.warn("ko có thumb dùng top gallery");for(var c=0;c<i.length;c++)(l={src:s[c].dataset.src||s[c].src||s[c].src,w:s[c].width,h:s[c].height,alt:s[c].alt,author:o.dataset.author}).msrc=n.getAttribute("src"),l.el=n,l.title=o.dataset.seo,l.m={src:s[c].dataset.src||s[c].src||s[c].src,w:s[c].width,alt:s[c].alt,h:s[c].height,author:o.dataset.author},l.o={src:i[c].content,w:+i[c].parentElement.querySelector("[itemprop=width]").content,alt:s[c].alt,h:+i[c].parentElement.querySelector("[itemprop=height]").content,author:o.dataset.author},a.push(l);var d,u,p={index:t,history:!1,focus:!1,hideAnimationDuration:0,getThumbBoundsFn:function(e){var t=a[e].el,l=window.pageYOffset||document.documentElement.scrollTop,r=t.getBoundingClientRect();return{x:r.left,y:r.top+l,w:r.width}},galleryUID:e},g=new PhotoSwipe(r,PhotoSwipeUI_Default,a,p),h=!1,m=!0;g.listen("beforeResize",function(){var e=window.devicePixelRatio?window.devicePixelRatio:1;e=Math.min(e,2.5),(d=g.viewportSize.x*e)>=1200||!g.likelyTouchDevice&&d>800||screen.width>1200?h||(h=!0,u=!0,console.log(screen.width+"use largeImage")):h&&(h=!1,u=!0,console.log(screen.width+"not use largeImage")),u&&!m&&g.invalidateCurrItems(),m&&(m=!1),u=!1}),g.listen("gettingData",function(e,t){h?(t.src=t.o.src,t.alt=t.o.alt,t.w=t.o.w,t.h=t.o.h):(t.src=t.m.src,t.alt=t.o.alt,t.w=t.m.w,t.h=t.m.h)}),g.init()}document.addEventListener("DOMContentLoaded",function(e){LoadSwiperDefault(),document.querySelector("._p-show-photowipe").addEventListener("click",function(e){var t=Array.from(galleryTop.slides).findIndex(e=>e.classList.contains("swiper-slide-active"))||galleryTop.activeIndex;_LoadImageSwipe(e.target.dataset.selector,t)})});